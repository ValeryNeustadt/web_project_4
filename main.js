!function(){"use strict";class e{constructor(e,t,s,r,o){this._name=e.name,this._link=e.link,this._id=e._id,this._cardOwnerId=e.owner._id,this._likes=e.likes,this._handleCardClick=t,this._handleCardDelete=s,this._handleToggleLikes=r,this._userId=o._id}_getTemplate(){return document.querySelector("#gallery").content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._element.id=this._id,this._trashButton=this._element.querySelector(".element__trash-button"),this._likeButton=this._element.querySelector(".element__button-like"),this._imageElement=this._element.querySelector(".element__photo"),this._imageText=this._element.querySelector(".element__text"),this._likeNumber=this._element.querySelector(".element__number-like"),this._showLikesNumber(),this.isLiked()&&this.toggleLikeButton(this._likes),this._imageText.textContent=this._name,this._imageElement.src=this._link,this._imageElement.alt=`Photo of ${this._link}`,this._setEventListeners(this._id),this._showTrashButton(),this._element}_showLikesNumber(){this._likes.length>0?this._likeNumber.textContent=this._likes.length:this._likeNumber.textContent=""}_showTrashButton(){this._cardOwnerId===this._userId&&this._trashButton.classList.add("element__trash-button_visible")}_setEventListeners(){this._trashButton.addEventListener("click",(()=>{this._handleCardDelete(this._element.id)})),this._likeButton.addEventListener("click",(()=>{this._handleToggleLikes(this._element.id)})),this._imageElement.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}removeElement(){this._element.remove(),this._element=null}toggleLikeButton(e){this._likes=e,this._showLikesNumber(),this._likeButton.classList.toggle("element__button-like_active")}isLiked(){return this._likes.some((e=>e._id===this._userId))}}class t{constructor(e){this._popupSelector=e}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"==e.key&&this.close()};setEventListeners(){this._popupSelector.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close-button"))&&this.close()}))}}class s{constructor(e,t){this._formElement=t.querySelector(e.formSelector),this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showError(e){e.classList.add(this._inputErrorClass);const t=this._formElement.querySelector(`${this._inputSelector}-${e.name}-error`);t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideError(e){e.classList.remove(this._inputErrorClass);const t=this._formElement.querySelector(`${this._inputSelector}-${e.name}-error`);t.textContent="",t.classList.remove(this._errorClass)}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputs.some((e=>!e.validity.valid))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListener()}resetValidity(){this._inputs.forEach((e=>{this._hideError(e)}))}_toggleInputError(e){e.validity.valid?this._hideError(e):this._showError(e)}_setEventListener(){this._inputs=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this.toggleButtonState(),this._toggleInputError(e)}))}))}}class r{constructor(e,t){let{data:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items,this._items.forEach(this._renderer)}appendItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}class o extends t{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popupSelector.querySelector(".form"),this._inputList=this._popupSelector.querySelectorAll(".form__input"),this._submitButton=this._form.querySelector(".form__button"),this._submitButtonTextContent=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.renderLoading(!0),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}close(){super.close(),this._form.reset()}renderLoading(e){this._submitButton.textContent=e?"Saving...":this._submitButtonTextContent}}const n=document.querySelector(".profile__add-button"),i=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__avatar"),a=document.querySelector("#popup__profileform"),h=document.querySelector("#popup__addplaceform"),u=document.querySelector("#popup__updateavatar"),_=document.querySelector("#popup__confirm"),c=document.querySelector("#profileform__name"),d=document.querySelector("#profileform__about-me"),m=document.querySelector("#imagepreview"),p={formSelector:".popup__form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},f=new class{constructor(e){this._url=e.baseUrl,this._token=e.token}getInitialCards(){return fetch(`${this._url}/cards`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserData(){return fetch(`${this._url}/users/me`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard(e,t){return fetch(`${this._url}/cards`,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserData(e,t){return console.log(e),fetch(`${this._url}/users/me`,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLikes(e){return fetch(`${this._url}/cards/likes/${e}`,{method:"PUT",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteLikes(e){return fetch(`${this._url}/cards/likes/${e}`,{method:"DELETE",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserAvatar(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",token:"02d6028b-ac6a-4274-af91-85096bd7453f"}),g=new s(p,h),E=new s(p,u),k=new s(p,a),S=new class extends t{constructor(e){super(e),this._popupImageContent=this._popupSelector.querySelector(".popup__image-content"),this._popupImageHeader=this._popupSelector.querySelector(".popup__image-header")}_rendrePopupImagePreview(){this._popupImageContent.setAttribute("src",`${this.link}`),this._popupImageContent.setAttribute("alt",`Photo of ${this.name}`),this._popupImageHeader.textContent=this.name}open(e){this.name=e.name,this.link=e.link,super.open(),this._rendrePopupImagePreview()}}(m);S.setEventListeners();const L=new class extends t{constructor(e){super(e),this._form=this._popupSelector.querySelector(".form"),this._submitButton=this._form.querySelector(".form__button"),this._submitButtonTextContent=this._submitButton.textContent}setAction(e){this._handleFormSubmit=e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.renderLoading(!0),this._handleFormSubmit(),super.close()})),super.setEventListeners()}renderLoading(e){this._submitButton.textContent=e?"Deleting...":this._submitButtonTextContent}}(_);function v(t,s){const r=new e(t,(e=>{S.open(e)}),(e=>{L.open(),L.setAction((()=>{f.deleteCard(e).then((e=>{r.removeElement()})).catch((e=>{console.log(`Error: ${e}`)})).finally((()=>{L.renderLoading(!1)}))}))}),(e=>{r.isLiked()?f.deleteLikes(e).then((e=>{r.toggleLikeButton(e.likes)})).catch((e=>{console.log(`Error: ${e}`)})):f.addLikes(e).then((e=>{r.toggleLikeButton(e.likes)})).catch((e=>{console.log(`Error: ${e}`)}))}),s);return r.generateCard()}L.setEventListeners();const b=new class{constructor(e,t,s,r){this._profileName=document.querySelector(e),this._profileProfession=document.querySelector(t),this._id=document.querySelector(s),this._image=document.querySelector(r)}getUserInfo(){return{profileName:this._profileName.textContent,profileProfession:this._profileProfession.textContent}}setUserInfo(e,t,s){this._profileName.textContent=e,this._profileProfession.textContent=t,this._id.id=s}setUserImage(e){this._image.src=e,this._image.alt=`Photo of ${this._profileName.textContent}`}}(".profile__name",".profile__profession",".profile__info",".profile__avatar-image");let y;Promise.all([f.getInitialCards(),f.getUserData()]).then((e=>{let[t,s]=e;b.setUserInfo(s.name,s.about,s._id),b.setUserImage(s.avatar),y=new r({data:t,renderer:e=>{const t=v(e,s);y.appendItem(t)}},".gallery__elements"),y.renderItems()})).catch((e=>{console.log(`Error: ${e}`)}));const C=new o(h,(e=>{const t={name:e.title,link:e["image-link"]};f.addCard(t.name,t.link).then((e=>{const t=v(e,e.owner);y.prependItem(t),C.close()})).catch((e=>{console.log(`Error: ${e}`),C.renderLoading(!1)})).finally((()=>{C.renderLoading(!1)}))})),B=new o(a,(e=>{const t=e.name,s=e["about-me"];f.setUserData(t,s).then((e=>{console.log(e),b.setUserInfo(e.name,e.about,e._id),B.close()})).catch((e=>{console.log(`Error: ${e}`),B.renderLoading(!1)})).finally((()=>{B.renderLoading(!1)}))})),I=new o(u,(e=>{const t=e["image-link"];f.setUserAvatar(t).then((e=>{b.setUserImage(t),I.close()})).catch((e=>{console.log(`Error: ${e}`),I.renderLoading(!1)})).finally((()=>{I.renderLoading(!1)}))}));E.enableValidation(),g.enableValidation(),k.enableValidation(),C.setEventListeners(),B.setEventListeners(),I.setEventListeners(),n.addEventListener("click",(function(){g.toggleButtonState(),g.resetValidity(),C.open()})),i.addEventListener("click",(function(){const e=b.getUserInfo();c.value=e.profileName,d.value=e.profileProfession,k.toggleButtonState(),k.resetValidity(),B.open()})),l.addEventListener("click",(function(){E.toggleButtonState(),E.resetValidity(),I.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBa0I1SixNQUNwQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtRGVsZXRlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXG4gICAgaGFuZGxlQ2FyZERlbGV0ZSxcbiAgICBoYW5kbGVUb2dnbGVMaWtlcyxcbiAgICB1c2VyRGF0YVxuICApIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9jYXJkT3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSA9IGhhbmRsZUNhcmREZWxldGU7XG4gICAgdGhpcy5faGFuZGxlVG9nZ2xlTGlrZXMgPSBoYW5kbGVUb2dnbGVMaWtlcztcbiAgICB0aGlzLl91c2VySWQgPSB1c2VyRGF0YS5faWQ7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgZ2FsbGVyeUVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjZ2FsbGVyeVwiKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiBnYWxsZXJ5RWxlbWVudDtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9lbGVtZW50LmlkID0gdGhpcy5faWQ7XG4gICAgdGhpcy5fdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdHJhc2gtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYnV0dG9uLWxpa2VcIik7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3Bob3RvXCIpO1xuICAgIHRoaXMuX2ltYWdlVGV4dCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X190ZXh0XCIpO1xuICAgIHRoaXMuX2xpa2VOdW1iZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbnVtYmVyLWxpa2VcIik7XG4gICAgdGhpcy5fc2hvd0xpa2VzTnVtYmVyKCk7XG5cbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcbiAgICAgIHRoaXMudG9nZ2xlTGlrZUJ1dHRvbih0aGlzLl9saWtlcyk7XG4gICAgfVxuXG4gICAgdGhpcy5faW1hZ2VUZXh0LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbGlua31gO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKHRoaXMuX2lkKTtcbiAgICB0aGlzLl9zaG93VHJhc2hCdXR0b24oKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX3Nob3dMaWtlc051bWJlcigpIHtcbiAgICBpZiAodGhpcy5fbGlrZXMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5fbGlrZU51bWJlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZU51bWJlci50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgfVxuICB9XG4gIF9zaG93VHJhc2hCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX2NhcmRPd25lcklkID09PSB0aGlzLl91c2VySWQpIHtcbiAgICAgIHRoaXMuX3RyYXNoQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X190cmFzaC1idXR0b25fdmlzaWJsZVwiKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGUodGhpcy5fZWxlbWVudC5pZCk7XG4gICAgfSk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlVG9nZ2xlTGlrZXModGhpcy5fZWxlbWVudC5pZCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSk7XG4gICAgfSk7XG4gIH1cblxuICByZW1vdmVFbGVtZW50KCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICB0b2dnbGVMaWtlQnV0dG9uKG5ld0xpa2VzKSB7XG4gICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcbiAgICB0aGlzLl9zaG93TGlrZXNOdW1iZXIoKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50X19idXR0b24tbGlrZV9hY3RpdmVcIik7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChwZXJzb24pID0+IHBlcnNvbi5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpIHx8XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlLWJ1dHRvblwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0aW9uIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvblBhcmFtcywgZm9ybSkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybS5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25QYXJhbXMuZm9ybVNlbGVjdG9yKTsgLy8gXCIjcG9wdXBfX2FkZHBsYWNlZm9ybVwiIG9yIFwiI3BvcHVwX19wcm9maWxlZm9ybVwiXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gdmFsaWRhdGlvblBhcmFtcy5mb3JtU2VsZWN0b3I7IC8vXCIucG9wdXBfX2Zvcm1cIixcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gdmFsaWRhdGlvblBhcmFtcy5pbnB1dFNlbGVjdG9yOyAvL1wiLmZvcm1fX2lucHV0XCIsXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSB2YWxpZGF0aW9uUGFyYW1zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yOyAvL1wiLmZvcm1fX2J1dHRvblwiLFxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSB2YWxpZGF0aW9uUGFyYW1zLmluYWN0aXZlQnV0dG9uQ2xhc3M7IC8vXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSB2YWxpZGF0aW9uUGFyYW1zLmlucHV0RXJyb3JDbGFzczsgLy9cImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gdmFsaWRhdGlvblBhcmFtcy5lcnJvckNsYXNzOyAvL1wiZm9ybV9fZXJyb3JfdmlzaWJsZVwiLFxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3Nob3dFcnJvcihpbnB1dEl0ZW0pIHtcbiAgICBpbnB1dEl0ZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgJHt0aGlzLl9pbnB1dFNlbGVjdG9yfS0ke2lucHV0SXRlbS5uYW1lfS1lcnJvcmBcbiAgICApO1xuICAgIGVycm9yTWVzc2FnZS50ZXh0Q29udGVudCA9IGlucHV0SXRlbS52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2UuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlRXJyb3IoaW5wdXRJdGVtKSB7XG4gICAgaW5wdXRJdGVtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCR7dGhpcy5faW5wdXRTZWxlY3Rvcn0tJHtpbnB1dEl0ZW0ubmFtZX0tZXJyb3JgXG4gICAgKTtcbiAgICBlcnJvck1lc3NhZ2UudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0cy5zb21lKChpbnB1dCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXIoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRpdHkoKSB7XG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0SXRlbSkgPT4ge1xuICAgICAgdGhpcy5faGlkZUVycm9yKGlucHV0SXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBfdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEl0ZW0pIHtcbiAgICBpZiAoaW5wdXRJdGVtLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXRJdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2hvd0Vycm9yKGlucHV0SXRlbSk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXIoKSB7XG4gICAgdGhpcy5faW5wdXRzID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dEl0ZW0pID0+IHtcbiAgICAgIGlucHV0SXRlbS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUlucHV0RXJyb3IoaW5wdXRJdGVtKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGRhdGE7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zO1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xuICB9XG5cbiAgYXBwZW5kSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcbiAgfVxuICBwcmVwZW5kSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4gKGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSkpO1xuICAgIHJldHVybiBmb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHRDb250ZW50O1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXG4pO1xuXG5leHBvcnQgY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUluZm9TZWxlY3RvciA9IFwiLnByb2ZpbGVfX2luZm9cIjtcbmV4cG9ydCBjb25zdCB1c2VySW1hZ2VTZWxlY3RvciA9IFwiLnByb2ZpbGVfX2F2YXRhci1pbWFnZVwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gXCIucHJvZmlsZV9fbmFtZVwiO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVQcm9mZXNzaW9uID0gXCIucHJvZmlsZV9fcHJvZmVzc2lvblwiO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwX19wcm9maWxlZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhZGRQbGFjZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwX19hZGRwbGFjZWZvcm1cIik7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBfX3VwZGF0ZWF2YXRhclwiKTtcblxuZXhwb3J0IGNvbnN0IGNvbmZpcm1Qb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBfX2NvbmZpcm1cIik7XG5cbmV4cG9ydCBjb25zdCBpbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVmb3JtX19uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IGlucHV0QWJvdXRtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZWZvcm1fX2Fib3V0LW1lXCIpO1xuXG5leHBvcnQgY29uc3QgaW1hZ2VQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZXByZXZpZXdcIik7XG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblBhcmFtcyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0U2VjdGlvbiA9IFwiLmdhbGxlcnlfX2VsZW1lbnRzXCI7XG5cbmV4cG9ydCBjb25zdCBnYWxsZXJ5Q2FyZHNJbnB1dHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcbiIsImltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgUG9wdXBDb25maXJtRGVsZXRlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtRGVsZXRlLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcblxuaW1wb3J0IHtcbiAgcHJvZmlsZUFkZEJ1dHRvbixcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIGF2YXRhckVkaXRCdXR0b24sXG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlUHJvZmVzc2lvbixcbiAgcHJvZmlsZUZvcm0sXG4gIGFkZFBsYWNlRm9ybSxcbiAgYXZhdGFyRm9ybSxcbiAgaW5wdXROYW1lLFxuICBpbnB1dEFib3V0bWUsXG4gIGltYWdlUHJldmlldyxcbiAgdmFsaWRhdGlvblBhcmFtcyxcbiAgY2FyZExpc3RTZWN0aW9uLFxuICBjb25maXJtUG9wdXAsXG4gIHByb2ZpbGVJbmZvU2VsZWN0b3IsXG4gIHVzZXJJbWFnZVNlbGVjdG9yLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcbiAgdG9rZW46IFwiMDJkNjAyOGItYWM2YS00Mjc0LWFmOTEtODUwOTZiZDc0NTNmXCIsXG59KTtcblxuY29uc3QgYWRkUGxhY2VGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0aW9uKFxuICB2YWxpZGF0aW9uUGFyYW1zLFxuICBhZGRQbGFjZUZvcm1cbik7XG5cbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRpb24odmFsaWRhdGlvblBhcmFtcywgYXZhdGFyRm9ybSk7XG5cbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0aW9uKHZhbGlkYXRpb25QYXJhbXMsIHByb2ZpbGVGb3JtKTtcblxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoaW1hZ2VQcmV2aWV3KTtcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGNvbmZpcm1EZWxldGVQb3B1cCA9IG5ldyBQb3B1cENvbmZpcm1EZWxldGUoY29uZmlybVBvcHVwKTtcbmNvbmZpcm1EZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEsIHVzZXJEYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBkYXRhLFxuICAgIChpbWFnZURhdGEpID0+IHtcbiAgICAgIHBvcHVwV2l0aEltYWdlLm9wZW4oaW1hZ2VEYXRhKTtcbiAgICB9LFxuICAgIChjYXJkSWQpID0+IHtcbiAgICAgIGNvbmZpcm1EZWxldGVQb3B1cC5vcGVuKCk7XG4gICAgICBjb25maXJtRGVsZXRlUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlRWxlbWVudCgpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICBjb25maXJtRGVsZXRlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIChjYXJkSWQpID0+IHtcbiAgICAgIGNvbnN0IGNoZWNrTGlrZWQgPSBjYXJkLmlzTGlrZWQoKTtcbiAgICAgIGlmIChjaGVja0xpa2VkKSB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5kZWxldGVMaWtlcyhjYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY2FyZC50b2dnbGVMaWtlQnV0dG9uKHJlcy5saWtlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5hZGRMaWtlcyhjYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY2FyZC50b2dnbGVMaWtlQnV0dG9uKHJlcy5saWtlcyk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHVzZXJEYXRhXG4gICk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVQcm9mZXNzaW9uLFxuICBwcm9maWxlSW5mb1NlbGVjdG9yLFxuICB1c2VySW1hZ2VTZWxlY3RvclxuKTtcblxubGV0IGNhcmRTZWN0aW9uO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckRhdGEoKV0pXG4gIC50aGVuKChbY2FyZHMsIHVzZXJEYXRhXSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0LCB1c2VyRGF0YS5faWQpO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbWFnZSh1c2VyRGF0YS5hdmF0YXIpO1xuICAgIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGRhdGE6IGNhcmRzLFxuICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHJlbmRlckNhcmQoZGF0YSwgdXNlckRhdGEpO1xuICAgICAgICAgIGNhcmRTZWN0aW9uLmFwcGVuZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIGNhcmRMaXN0U2VjdGlvblxuICAgICk7XG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xuICB9KTtcblxuY29uc3QgYWRkUGxhY2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKGFkZFBsYWNlRm9ybSwgKGRhdGEpID0+IHtcbiAgY29uc3QgY2FyZERhdGEgPSB7XG4gICAgbmFtZTogZGF0YVtcInRpdGxlXCJdLFxuICAgIGxpbms6IGRhdGFbXCJpbWFnZS1saW5rXCJdLFxuICB9O1xuICBhcGlcbiAgICAuYWRkQ2FyZChjYXJkRGF0YS5uYW1lLCBjYXJkRGF0YS5saW5rKVxuICAgIC50aGVuKChwb3N0KSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHJlbmRlckNhcmQocG9zdCwgcG9zdC5vd25lcik7XG4gICAgICBjYXJkU2VjdGlvbi5wcmVwZW5kSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICBhZGRQbGFjZVBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcbiAgICAgIGFkZFBsYWNlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhZGRQbGFjZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHByb2ZpbGVGb3JtLCAoZGF0YSkgPT4ge1xuICBjb25zdCBpbnB1dE5hbWUgPSBkYXRhW1wibmFtZVwiXTtcbiAgY29uc3QgaW5wdXRBYm91dE1lID0gZGF0YVtcImFib3V0LW1lXCJdO1xuICBhcGlcbiAgICAuc2V0VXNlckRhdGEoaW5wdXROYW1lLCBpbnB1dEFib3V0TWUpXG4gICAgLnRoZW4oKHBvc3QpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHBvc3QpO1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocG9zdC5uYW1lLCBwb3N0LmFib3V0LCBwb3N0Ll9pZCk7XG4gICAgICBwcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xuICAgICAgcHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IHVwZGF0ZUF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oYXZhdGFyRm9ybSwgKGRhdGEpID0+IHtcbiAgY29uc3QgaW1hZ2VMaW5rID0gZGF0YVtcImltYWdlLWxpbmtcIl07XG4gIGFwaVxuICAgIC5zZXRVc2VyQXZhdGFyKGltYWdlTGluaylcbiAgICAudGhlbigocG9zdCkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckltYWdlKGltYWdlTGluayk7XG4gICAgICB1cGRhdGVBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XG4gICAgICB1cGRhdGVBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHVwZGF0ZUF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufSk7XG5cbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkUGxhY2VGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZFBsYWNlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xudXBkYXRlQXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEJ1dHRvbkNsaWNrKCkge1xuICBhZGRQbGFjZUZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgYWRkUGxhY2VGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRpdHkoKTtcbiAgYWRkUGxhY2VQb3B1cC5vcGVuKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRQcm9maWxlQnV0dG9uQ2xpY2soKSB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgaW5wdXROYW1lLnZhbHVlID0gdXNlckRhdGEucHJvZmlsZU5hbWU7XG4gIGlucHV0QWJvdXRtZS52YWx1ZSA9IHVzZXJEYXRhLnByb2ZpbGVQcm9mZXNzaW9uO1xuICBwcm9maWxlRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICBwcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkaXR5KCk7XG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRBdmF0YXJCdXR0b25DbGljaygpIHtcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRpdHkoKTtcbiAgdXBkYXRlQXZhdGFyUG9wdXAub3BlbigpO1xufVxuXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBZGRDYXJkQnV0dG9uQ2xpY2spO1xucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUVkaXRQcm9maWxlQnV0dG9uQ2xpY2spO1xuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdEF2YXRhckJ1dHRvbkNsaWNrKTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5fdXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX3Rva2VuID0gb3B0aW9ucy50b2tlbjtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXG4gICAgICB9LFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXJEYXRhKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcbiAgICAgIH0sXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkQ2FyZChuYW1lLCBsaW5rKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0VXNlckRhdGEoaW5wdXROYW1lLCBpbnB1dEFib3V0TWUpIHtcbiAgICBjb25zb2xlLmxvZyhpbnB1dE5hbWUpO1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGlucHV0TmFtZSxcbiAgICAgICAgYWJvdXQ6IGlucHV0QWJvdXRNZSxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcbiAgICAgIH0sXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkTGlrZXMoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcbiAgICAgIH0sXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlTGlrZXMoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcbiAgICAgIH0sXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZUNvbnRlbnQgPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5wb3B1cF9faW1hZ2UtY29udGVudFwiXG4gICAgKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlSGVhZGVyID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX2ltYWdlLWhlYWRlclwiXG4gICAgKTtcbiAgfVxuXG4gIF9yZW5kcmVQb3B1cEltYWdlUHJldmlldygpIHtcbiAgICB0aGlzLl9wb3B1cEltYWdlQ29udGVudC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgYCR7dGhpcy5saW5rfWApO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2VDb250ZW50LnNldEF0dHJpYnV0ZShcImFsdFwiLCBgUGhvdG8gb2YgJHt0aGlzLm5hbWV9YCk7XG4gICAgdGhpcy5fcG9wdXBJbWFnZUhlYWRlci50ZXh0Q29udGVudCA9IHRoaXMubmFtZTtcbiAgfVxuXG4gIG9wZW4oZGF0YSkge1xuICAgIHRoaXMubmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLmxpbmsgPSBkYXRhLmxpbms7XG4gICAgc3VwZXIub3BlbigpO1xuICAgIHRoaXMuX3JlbmRyZVBvcHVwSW1hZ2VQcmV2aWV3KCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuZXhwb3J0IGNsYXNzIFBvcHVwQ29uZmlybURlbGV0ZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgc2V0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBhY3Rpb247XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xuICAgICAgc3VwZXIuY2xvc2UoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHRDb250ZW50O1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJvZmlsZU5hbWUsXG4gICAgcHJvZmlsZVByb2Zlc3Npb24sXG4gICAgcHJvZmlsZUluZm9TZWxlY3RvcixcbiAgICB1c2VySW1hZ2VTZWxlY3RvclxuICApIHtcbiAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWUpO1xuICAgIHRoaXMuX3Byb2ZpbGVQcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlUHJvZmVzc2lvbik7XG4gICAgdGhpcy5faWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVJbmZvU2VsZWN0b3IpO1xuICAgIHRoaXMuX2ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VySW1hZ2VTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCB1c2VyVmFsdWVzID0ge1xuICAgICAgcHJvZmlsZU5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxuICAgICAgcHJvZmlsZVByb2Zlc3Npb246IHRoaXMuX3Byb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50LFxuICAgIH07XG4gICAgcmV0dXJuIHVzZXJWYWx1ZXM7XG4gIH1cblxuICBzZXRVc2VySW5mbyhpbnB1dE5hbWUsIGlucHV0QWJvdXRNZSwgaWQpIHtcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGlucHV0TmFtZTtcbiAgICB0aGlzLl9wcm9maWxlUHJvZmVzc2lvbi50ZXh0Q29udGVudCA9IGlucHV0QWJvdXRNZTtcbiAgICB0aGlzLl9pZC5pZCA9IGlkO1xuICB9XG5cbiAgc2V0VXNlckltYWdlKGltYWdlTGluaykge1xuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGltYWdlTGluaztcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudH1gO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUNhcmREZWxldGUiLCJoYW5kbGVUb2dnbGVMaWtlcyIsInVzZXJEYXRhIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9jYXJkT3duZXJJZCIsIm93bmVyIiwiX2xpa2VzIiwibGlrZXMiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUNhcmREZWxldGUiLCJfaGFuZGxlVG9nZ2xlTGlrZXMiLCJfdXNlcklkIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiaWQiLCJfdHJhc2hCdXR0b24iLCJfbGlrZUJ1dHRvbiIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VUZXh0IiwiX2xpa2VOdW1iZXIiLCJfc2hvd0xpa2VzTnVtYmVyIiwiaXNMaWtlZCIsInRvZ2dsZUxpa2VCdXR0b24iLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9zaG93VHJhc2hCdXR0b24iLCJsZW5ndGgiLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRWxlbWVudCIsInJlbW92ZSIsIm5ld0xpa2VzIiwidG9nZ2xlIiwic29tZSIsInBlcnNvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cFNlbGVjdG9yIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJGb3JtVmFsaWRhdGlvbiIsInZhbGlkYXRpb25QYXJhbXMiLCJmb3JtIiwiX2Zvcm1FbGVtZW50IiwiZm9ybVNlbGVjdG9yIiwiX2Zvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9idXR0b25FbGVtZW50IiwiX3Nob3dFcnJvciIsImlucHV0SXRlbSIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVFcnJvciIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiX2lucHV0cyIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJfc2V0RXZlbnRMaXN0ZW5lciIsInJlc2V0VmFsaWRpdHkiLCJmb3JFYWNoIiwiX3RvZ2dsZUlucHV0RXJyb3IiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYXBwZW5kSXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJwcmVwZW5kSXRlbSIsInByZXBlbmQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJfc3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblRleHRDb250ZW50IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsInJlc2V0IiwiaXNMb2FkaW5nIiwicHJvZmlsZUFkZEJ1dHRvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYXZhdGFyRWRpdEJ1dHRvbiIsInByb2ZpbGVGb3JtIiwiYWRkUGxhY2VGb3JtIiwiYXZhdGFyRm9ybSIsImNvbmZpcm1Qb3B1cCIsImlucHV0TmFtZSIsImlucHV0QWJvdXRtZSIsImltYWdlUHJldmlldyIsImFwaSIsIm9wdGlvbnMiLCJfdXJsIiwiYmFzZVVybCIsIl90b2tlbiIsInRva2VuIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckRhdGEiLCJhZGRDYXJkIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRVc2VyRGF0YSIsImlucHV0QWJvdXRNZSIsImNvbnNvbGUiLCJsb2ciLCJhYm91dCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlcyIsImRlbGV0ZUxpa2VzIiwic2V0VXNlckF2YXRhciIsImF2YXRhciIsImFkZFBsYWNlRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsInBvcHVwV2l0aEltYWdlIiwiX3BvcHVwSW1hZ2VDb250ZW50IiwiX3BvcHVwSW1hZ2VIZWFkZXIiLCJfcmVuZHJlUG9wdXBJbWFnZVByZXZpZXciLCJzZXRBdHRyaWJ1dGUiLCJjb25maXJtRGVsZXRlUG9wdXAiLCJzZXRBY3Rpb24iLCJhY3Rpb24iLCJyZW5kZXJDYXJkIiwiY2FyZCIsImltYWdlRGF0YSIsImNhdGNoIiwiZXJyIiwiZmluYWxseSIsInVzZXJJbmZvIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlUHJvZmVzc2lvbiIsInByb2ZpbGVJbmZvU2VsZWN0b3IiLCJ1c2VySW1hZ2VTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlUHJvZmVzc2lvbiIsIl9pbWFnZSIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJzZXRVc2VySW1hZ2UiLCJpbWFnZUxpbmsiLCJjYXJkU2VjdGlvbiIsImFsbCIsImNhcmRzIiwiY2FyZEVsZW1lbnQiLCJhZGRQbGFjZVBvcHVwIiwiY2FyZERhdGEiLCJwb3N0IiwicHJvZmlsZVBvcHVwIiwidXBkYXRlQXZhdGFyUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9