!function(){"use strict";class e{constructor(e,t,s,r,o){this._name=e.name,this._link=e.link,this._id=e._id,this._cardOwnerId=e.owner._id,this._likes=e.likes,this._handleCardClick=t,this._handleCardDelete=s,this._handleToggleLikes=r,this._userId=o._id}_getTemplate(){return document.querySelector("#gallery").content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._element.id=this._id,this._trashButton=this._element.querySelector(".element__trash-button"),this._likeButton=this._element.querySelector(".element__button-like"),this._imageElement=this._element.querySelector(".element__photo"),this._imageText=this._element.querySelector(".element__text"),this._likeNumber=this._element.querySelector(".element__number-like"),this._showLikesNumber(),this.isLiked()&&this.toggleLikeButton(this._likes),this._imageText.textContent=this._name,this._imageElement.src=this._link,this._imageElement.alt=`Photo of ${this._link}`,this._setEventListeners(this._id),this._showTrashButton(),this._element}_showLikesNumber(){this._likes.length>0?this._likeNumber.textContent=this._likes.length:this._likeNumber.textContent=""}_showTrashButton(){this._cardOwnerId===this._userId&&this._trashButton.classList.add("element__trash-button_visible")}_setEventListeners(){this._trashButton.addEventListener("click",(()=>{this._handleCardDelete(this._element.id)})),this._likeButton.addEventListener("click",(()=>{this._handleToggleLikes(this._element.id)})),this._imageElement.addEventListener("click",(()=>{this._handleCardClick({name:this._name,link:this._link})}))}removeElement(){this._element.remove(),this._element=null}toggleLikeButton(e){this._likes=e,this._showLikesNumber(),this._likeButton.classList.toggle("element__button-like_active")}isLiked(){return this._likes.some((e=>e._id===this._userId))}}class t{constructor(e){this._popupSelector=e}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"==e.key&&this.close()};setEventListeners(){this._popupSelector.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close-button"))&&this.close()}))}}class s{constructor(e,t){this._formElement=t.querySelector(e.formSelector),this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showError(e){e.classList.add(this._inputErrorClass);const t=this._formElement.querySelector(`${this._inputSelector}-${e.name}-error`);t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideError(e){e.classList.remove(this._inputErrorClass);const t=this._formElement.querySelector(`${this._inputSelector}-${e.name}-error`);t.textContent="",t.classList.remove(this._errorClass)}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputs.some((e=>!e.validity.valid))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListener()}resetValidity(){this._inputs.forEach((e=>{this._hideError(e)}))}_toggleInputError(e){e.validity.valid?this._hideError(e):this._showError(e)}_setEventListener(){this._inputs=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this.toggleButtonState(),this._toggleInputError(e)}))}))}}class r{constructor(e,t){let{data:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items,this._items.forEach(this._renderer)}appendItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}}class o extends t{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popupSelector.querySelector(".form"),this._inputList=this._popupSelector.querySelectorAll(".form__input"),this._submitButton=this._form.querySelector(".form__button"),this._submitButtonTextContent=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.renderLoading(!0),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}close(){super.close(),this._form.reset()}renderLoading(e){this._submitButton.textContent=e?"Saving...":this._submitButtonTextContent}}const n=document.querySelector(".profile__add-button"),i=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__avatar"),a=document.querySelector("#popup__profileform"),h=document.querySelector("#popup__addplaceform"),u=document.querySelector("#popup__updateavatar"),_=document.querySelector("#popup__confirm"),c=document.querySelector("#profileform__name"),d=document.querySelector("#profileform__about-me"),m=document.querySelector("#imagepreview"),p={formSelector:".popup__form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},f=new class{constructor(e){this._url=e.baseUrl,this._token=e.token}getInitialCards(){return fetch(`${this._url}/cards`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserData(){return fetch(`${this._url}/users/me`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard(e,t){return fetch(`${this._url}/cards`,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserData(e,t){return console.log(e),fetch(`${this._url}/users/me`,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLikes(e){return fetch(`${this._url}/cards/likes/${e}`,{method:"PUT",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteLikes(e){return fetch(`${this._url}/cards/likes/${e}`,{method:"DELETE",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserAvatar(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",token:"02d6028b-ac6a-4274-af91-85096bd7453f"}),g=new s(p,h),E=new s(p,u),k=new s(p,a),S=new class extends t{constructor(e){super(e),this._popupImageContent=this._popupSelector.querySelector(".popup__image-content"),this._popupImageHeader=this._popupSelector.querySelector(".popup__image-header")}_rendrePopupImagePreview(){this._popupImageContent.setAttribute("src",`${this.link}`),this._popupImageContent.setAttribute("alt",`Photo of ${this.name}`),this._popupImageHeader.textContent=this.name}open(e){this.name=e.name,this.link=e.link,super.open(),this._rendrePopupImagePreview()}}(m);S.setEventListeners();const L=new class extends t{constructor(e){super(e),this._form=this._popupSelector.querySelector(".form"),this._submitButton=this._form.querySelector(".form__button"),this._submitButtonTextContent=this._submitButton.textContent}setAction(e){this._handleFormSubmit=e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.renderLoading(!0),this._handleFormSubmit(),super.close()})),super.setEventListeners()}renderLoading(e){this._submitButton.textContent=e?"Deleting...":this._submitButtonTextContent}}(_);function v(t,s){const r=new e(t,(e=>{S.open(e)}),(e=>{L.open(),L.setAction((()=>{f.deleteCard(e).then((e=>{r.removeElement()})).catch((e=>{console.log(`Error: ${e}`)})).finally((()=>{L.renderLoading(!1)}))}))}),(e=>{r.isLiked()?f.deleteLikes(e).then((e=>{r.toggleLikeButton(e.likes)})).catch((e=>{console.log(`Error: ${e}`)})):f.addLikes(e).then((e=>{r.toggleLikeButton(e.likes)})).catch((e=>{console.log(`Error: ${e}`)}))}),s);return r.generateCard()}L.setEventListeners();const b=new class{constructor(e,t,s,r){this._profileName=document.querySelector(e),this._profileProfession=document.querySelector(t),this._id=document.querySelector(s),this._image=document.querySelector(r)}getUserInfo(){return{profileName:this._profileName.textContent,profileProfession:this._profileProfession.textContent}}setUserInfo(e,t,s){this._profileName.textContent=e,this._profileProfession.textContent=t,this._id.id=s}setUserImage(e){this._image.src=e}}(".profile__name",".profile__profession",".profile__info",".profile__avatar-image");let y;Promise.all([f.getInitialCards(),f.getUserData()]).then((e=>{let[t,s]=e;b.setUserInfo(s.name,s.about,s._id),b.setUserImage(s.avatar),y=new r({data:t,renderer:e=>{const t=v(e,s);y.appendItem(t)}},".gallery__elements"),y.renderItems()})).catch((e=>{console.log(`Error: ${e}`)}));const C=new o(h,(e=>{const t={name:e.title,link:e["image-link"]};f.addCard(t.name,t.link).then((e=>{const t=v(e,e.owner);y.prependItem(t),C.close()})).catch((e=>{console.log(`Error: ${e}`),C.renderLoading(!1)})).finally((()=>{C.renderLoading(!1)}))})),B=new o(a,(e=>{const t=e.name,s=e["about-me"];f.setUserData(t,s).then((e=>{console.log(e),b.setUserInfo(e.name,e.about,e._id),B.close()})).catch((e=>{console.log(`Error: ${e}`),B.renderLoading(!1)})).finally((()=>{B.renderLoading(!1)}))})),I=new o(u,(e=>{const t=e["image-link"];f.setUserAvatar(t).then((e=>{b.setUserImage(t),I.close()})).catch((e=>{console.log(`Error: ${e}`),I.renderLoading(!1)})).finally((()=>{I.renderLoading(!1)}))}));E.enableValidation(),g.enableValidation(),k.enableValidation(),C.setEventListeners(),B.setEventListeners(),I.setEventListeners(),n.addEventListener("click",(function(){g.toggleButtonState(),g.resetValidity(),C.open()})),i.addEventListener("click",(function(){const e=b.getUserInfo();c.value=e.profileName,d.value=e.profileProfession,k.toggleButtonState(),k.resetValidity(),B.open()})),l.addEventListener("click",(function(){E.toggleButtonState(),E.resetValidity(),I.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dF9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGUuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVDYXJkRGVsZXRlLFxuICAgIGhhbmRsZVRvZ2dsZUxpa2VzLFxuICAgIHVzZXJEYXRhXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2NhcmRPd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlID0gaGFuZGxlQ2FyZERlbGV0ZTtcbiAgICB0aGlzLl9oYW5kbGVUb2dnbGVMaWtlcyA9IGhhbmRsZVRvZ2dsZUxpa2VzO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJEYXRhLl9pZDtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBnYWxsZXJ5RWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIiNnYWxsZXJ5XCIpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIGdhbGxlcnlFbGVtZW50O1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQuaWQgPSB0aGlzLl9pZDtcbiAgICB0aGlzLl90cmFzaEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X190cmFzaC1idXR0b25cIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b24tbGlrZVwiKTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fcGhvdG9cIik7XG4gICAgdGhpcy5faW1hZ2VUZXh0ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RleHRcIik7XG4gICAgdGhpcy5fbGlrZU51bWJlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19udW1iZXItbGlrZVwiKTtcbiAgICB0aGlzLl9zaG93TGlrZXNOdW1iZXIoKTtcblxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xuICAgICAgdGhpcy50b2dnbGVMaWtlQnV0dG9uKHRoaXMuX2xpa2VzKTtcbiAgICB9XG5cbiAgICB0aGlzLl9pbWFnZVRleHQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl9saW5rfWA7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnModGhpcy5faWQpO1xuICAgIHRoaXMuX3Nob3dUcmFzaEJ1dHRvbigpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBfc2hvd0xpa2VzTnVtYmVyKCkge1xuICAgIGlmICh0aGlzLl9saWtlcy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLl9saWtlTnVtYmVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlTnVtYmVyLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICB9XG4gIH1cbiAgX3Nob3dUcmFzaEJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5fY2FyZE93bmVySWQgPT09IHRoaXMuX3VzZXJJZCkge1xuICAgICAgdGhpcy5fdHJhc2hCdXR0b24uY2xhc3NMaXN0LmFkZChcImVsZW1lbnRfX3RyYXNoLWJ1dHRvbl92aXNpYmxlXCIpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl90cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSh0aGlzLl9lbGVtZW50LmlkKTtcbiAgICB9KTtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVUb2dnbGVMaWtlcyh0aGlzLl9lbGVtZW50LmlkKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUVsZW1lbnQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIHRvZ2dsZUxpa2VCdXR0b24obmV3TGlrZXMpIHtcbiAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xuICAgIHRoaXMuX3Nob3dMaWtlc051bWJlcigpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImVsZW1lbnRfX2J1dHRvbi1saWtlX2FjdGl2ZVwiKTtcbiAgfVxuXG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKHBlcnNvbikgPT4gcGVyc29uLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXBTZWxlY3RvciA9IHBvcHVwU2VsZWN0b3I7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQua2V5ID09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2UtYnV0dG9uXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRpb24ge1xuICBjb25zdHJ1Y3Rvcih2YWxpZGF0aW9uUGFyYW1zLCBmb3JtKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IodmFsaWRhdGlvblBhcmFtcy5mb3JtU2VsZWN0b3IpOyAvLyBcIiNwb3B1cF9fYWRkcGxhY2Vmb3JtXCIgb3IgXCIjcG9wdXBfX3Byb2ZpbGVmb3JtXCJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSB2YWxpZGF0aW9uUGFyYW1zLmZvcm1TZWxlY3RvcjsgLy9cIi5wb3B1cF9fZm9ybVwiLFxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSB2YWxpZGF0aW9uUGFyYW1zLmlucHV0U2VsZWN0b3I7IC8vXCIuZm9ybV9faW5wdXRcIixcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHZhbGlkYXRpb25QYXJhbXMuc3VibWl0QnV0dG9uU2VsZWN0b3I7IC8vXCIuZm9ybV9fYnV0dG9uXCIsXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHZhbGlkYXRpb25QYXJhbXMuaW5hY3RpdmVCdXR0b25DbGFzczsgLy9cImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHZhbGlkYXRpb25QYXJhbXMuaW5wdXRFcnJvckNsYXNzOyAvL1wiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSB2YWxpZGF0aW9uUGFyYW1zLmVycm9yQ2xhc3M7IC8vXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICBfc2hvd0Vycm9yKGlucHV0SXRlbSkge1xuICAgIGlucHV0SXRlbS5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAke3RoaXMuX2lucHV0U2VsZWN0b3J9LSR7aW5wdXRJdGVtLm5hbWV9LWVycm9yYFxuICAgICk7XG4gICAgZXJyb3JNZXNzYWdlLnRleHRDb250ZW50ID0gaW5wdXRJdGVtLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVFcnJvcihpbnB1dEl0ZW0pIHtcbiAgICBpbnB1dEl0ZW0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgJHt0aGlzLl9pbnB1dFNlbGVjdG9yfS0ke2lucHV0SXRlbS5uYW1lfS1lcnJvcmBcbiAgICApO1xuICAgIGVycm9yTWVzc2FnZS50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRzLnNvbWUoKGlucHV0KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcigpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGl0eSgpIHtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXRJdGVtKSA9PiB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXRJdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIF90b2dnbGVJbnB1dEVycm9yKGlucHV0SXRlbSkge1xuICAgIGlmIChpbnB1dEl0ZW0udmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX2hpZGVFcnJvcihpbnB1dEl0ZW0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zaG93RXJyb3IoaW5wdXRJdGVtKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcigpIHtcbiAgICB0aGlzLl9pbnB1dHMgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxuICAgICk7XG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0SXRlbSkgPT4ge1xuICAgICAgaW5wdXRJdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEl0ZW0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBkYXRhLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gZGF0YTtcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXM7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XG4gIH1cblxuICBhcHBlbmRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xuICB9XG4gIHByZXBlbmRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiAoZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlKSk7XG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dENvbnRlbnQ7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcbik7XG5cbmV4cG9ydCBjb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlSW5mb1NlbGVjdG9yID0gXCIucHJvZmlsZV9faW5mb1wiO1xuZXhwb3J0IGNvbnN0IHVzZXJJbWFnZVNlbGVjdG9yID0gXCIucHJvZmlsZV9fYXZhdGFyLWltYWdlXCI7XG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBcIi5wcm9maWxlX19uYW1lXCI7XG5leHBvcnQgY29uc3QgcHJvZmlsZVByb2Zlc3Npb24gPSBcIi5wcm9maWxlX19wcm9mZXNzaW9uXCI7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBfX3Byb2ZpbGVmb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGFkZFBsYWNlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBfX2FkZHBsYWNlZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cF9fdXBkYXRlYXZhdGFyXCIpO1xuXG5leHBvcnQgY29uc3QgY29uZmlybVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cF9fY29uZmlybVwiKTtcblxuZXhwb3J0IGNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZWZvcm1fX25hbWVcIik7XG5leHBvcnQgY29uc3QgaW5wdXRBYm91dG1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlZm9ybV9fYWJvdXQtbWVcIik7XG5cbmV4cG9ydCBjb25zdCBpbWFnZVByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlcHJldmlld1wiKTtcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uUGFyYW1zID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5leHBvcnQgY29uc3QgY2FyZExpc3RTZWN0aW9uID0gXCIuZ2FsbGVyeV9fZWxlbWVudHNcIjtcblxuZXhwb3J0IGNvbnN0IGdhbGxlcnlDYXJkc0lucHV0cyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5cbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBQb3B1cENvbmZpcm1EZWxldGUgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGUuanNcIjtcbmltcG9ydCB7IEZvcm1WYWxpZGF0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5pbXBvcnQge1xuICBwcm9maWxlQWRkQnV0dG9uLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgYXZhdGFyRWRpdEJ1dHRvbixcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVQcm9mZXNzaW9uLFxuICBwcm9maWxlRm9ybSxcbiAgYWRkUGxhY2VGb3JtLFxuICBhdmF0YXJGb3JtLFxuICBpbnB1dE5hbWUsXG4gIGlucHV0QWJvdXRtZSxcbiAgaW1hZ2VQcmV2aWV3LFxuICB2YWxpZGF0aW9uUGFyYW1zLFxuICBjYXJkTGlzdFNlY3Rpb24sXG4gIGNvbmZpcm1Qb3B1cCxcbiAgcHJvZmlsZUluZm9TZWxlY3RvcixcbiAgdXNlckltYWdlU2VsZWN0b3IsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxuICB0b2tlbjogXCIwMmQ2MDI4Yi1hYzZhLTQyNzQtYWY5MS04NTA5NmJkNzQ1M2ZcIixcbn0pO1xuXG5jb25zdCBhZGRQbGFjZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRpb24oXG4gIHZhbGlkYXRpb25QYXJhbXMsXG4gIGFkZFBsYWNlRm9ybVxuKTtcblxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdGlvbih2YWxpZGF0aW9uUGFyYW1zLCBhdmF0YXJGb3JtKTtcblxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRpb24odmFsaWRhdGlvblBhcmFtcywgcHJvZmlsZUZvcm0pO1xuXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShpbWFnZVByZXZpZXcpO1xucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgY29uZmlybURlbGV0ZVBvcHVwID0gbmV3IFBvcHVwQ29uZmlybURlbGV0ZShjb25maXJtUG9wdXApO1xuY29uZmlybURlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIHJlbmRlckNhcmQoZGF0YSwgdXNlckRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGRhdGEsXG4gICAgKGltYWdlRGF0YSkgPT4ge1xuICAgICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihpbWFnZURhdGEpO1xuICAgIH0sXG4gICAgKGNhcmRJZCkgPT4ge1xuICAgICAgY29uZmlybURlbGV0ZVBvcHVwLm9wZW4oKTtcbiAgICAgIGNvbmZpcm1EZWxldGVQb3B1cC5zZXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICBhcGlcbiAgICAgICAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY2FyZC5yZW1vdmVFbGVtZW50KCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGNvbmZpcm1EZWxldGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgKGNhcmRJZCkgPT4ge1xuICAgICAgY29uc3QgY2hlY2tMaWtlZCA9IGNhcmQuaXNMaWtlZCgpO1xuICAgICAgaWYgKGNoZWNrTGlrZWQpIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmRlbGV0ZUxpa2VzKGNhcmRJZClcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnRvZ2dsZUxpa2VCdXR0b24ocmVzLmxpa2VzKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmFkZExpa2VzKGNhcmRJZClcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkLnRvZ2dsZUxpa2VCdXR0b24ocmVzLmxpa2VzKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgdXNlckRhdGFcbiAgKTtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxuICBwcm9maWxlTmFtZSxcbiAgcHJvZmlsZVByb2Zlc3Npb24sXG4gIHByb2ZpbGVJbmZvU2VsZWN0b3IsXG4gIHVzZXJJbWFnZVNlbGVjdG9yXG4pO1xuXG5sZXQgY2FyZFNlY3Rpb247XG5cblByb21pc2UuYWxsKFthcGkuZ2V0SW5pdGlhbENhcmRzKCksIGFwaS5nZXRVc2VyRGF0YSgpXSlcbiAgLnRoZW4oKFtjYXJkcywgdXNlckRhdGFdKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQsIHVzZXJEYXRhLl9pZCk7XG4gICAgdXNlckluZm8uc2V0VXNlckltYWdlKHVzZXJEYXRhLmF2YXRhcik7XG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgZGF0YTogY2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gcmVuZGVyQ2FyZChkYXRhLCB1c2VyRGF0YSk7XG4gICAgICAgICAgY2FyZFNlY3Rpb24uYXBwZW5kSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgY2FyZExpc3RTZWN0aW9uXG4gICAgKTtcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XG4gIH0pO1xuXG5jb25zdCBhZGRQbGFjZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oYWRkUGxhY2VGb3JtLCAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkRGF0YSA9IHtcbiAgICBuYW1lOiBkYXRhW1widGl0bGVcIl0sXG4gICAgbGluazogZGF0YVtcImltYWdlLWxpbmtcIl0sXG4gIH07XG4gIGFwaVxuICAgIC5hZGRDYXJkKGNhcmREYXRhLm5hbWUsIGNhcmREYXRhLmxpbmspXG4gICAgLnRoZW4oKHBvc3QpID0+IHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gcmVuZGVyQ2FyZChwb3N0LCBwb3N0Lm93bmVyKTtcbiAgICAgIGNhcmRTZWN0aW9uLnByZXBlbmRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgIGFkZFBsYWNlUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xuICAgICAgYWRkUGxhY2VQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGFkZFBsYWNlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59KTtcblxuY29uc3QgcHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0ocHJvZmlsZUZvcm0sIChkYXRhKSA9PiB7XG4gIGNvbnN0IGlucHV0TmFtZSA9IGRhdGFbXCJuYW1lXCJdO1xuICBjb25zdCBpbnB1dEFib3V0TWUgPSBkYXRhW1wiYWJvdXQtbWVcIl07XG4gIGFwaVxuICAgIC5zZXRVc2VyRGF0YShpbnB1dE5hbWUsIGlucHV0QWJvdXRNZSlcbiAgICAudGhlbigocG9zdCkgPT4ge1xuICAgICAgY29uc29sZS5sb2cocG9zdCk7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhwb3N0Lm5hbWUsIHBvc3QuYWJvdXQsIHBvc3QuX2lkKTtcbiAgICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XG4gICAgICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59KTtcblxuY29uc3QgdXBkYXRlQXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShhdmF0YXJGb3JtLCAoZGF0YSkgPT4ge1xuICBjb25zdCBpbWFnZUxpbmsgPSBkYXRhW1wiaW1hZ2UtbGlua1wiXTtcbiAgYXBpXG4gICAgLnNldFVzZXJBdmF0YXIoaW1hZ2VMaW5rKVxuICAgIC50aGVuKChwb3N0KSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW1hZ2UoaW1hZ2VMaW5rKTtcbiAgICAgIHVwZGF0ZUF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcbiAgICAgIHVwZGF0ZUF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgdXBkYXRlQXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59KTtcblxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRQbGFjZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkUGxhY2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG51cGRhdGVBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkQnV0dG9uQ2xpY2soKSB7XG4gIGFkZFBsYWNlRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICBhZGRQbGFjZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGl0eSgpO1xuICBhZGRQbGFjZVBvcHVwLm9wZW4oKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRWRpdFByb2ZpbGVCdXR0b25DbGljaygpIHtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBpbnB1dE5hbWUudmFsdWUgPSB1c2VyRGF0YS5wcm9maWxlTmFtZTtcbiAgaW5wdXRBYm91dG1lLnZhbHVlID0gdXNlckRhdGEucHJvZmlsZVByb2Zlc3Npb247XG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRpdHkoKTtcbiAgcHJvZmlsZVBvcHVwLm9wZW4oKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRWRpdEF2YXRhckJ1dHRvbkNsaWNrKCkge1xuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIGF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGl0eSgpO1xuICB1cGRhdGVBdmF0YXJQb3B1cC5vcGVuKCk7XG59XG5cbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUFkZENhcmRCdXR0b25DbGljayk7XG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlRWRpdFByb2ZpbGVCdXR0b25DbGljayk7XG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVFZGl0QXZhdGFyQnV0dG9uQ2xpY2spOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5fdG9rZW4gPSBvcHRpb25zLnRva2VuO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcbiAgICAgIH0sXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0VXNlckRhdGEoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxuICAgICAgfSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRDYXJkKG5hbWUsIGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBzZXRVc2VyRGF0YShpbnB1dE5hbWUsIGlucHV0QWJvdXRNZSkge1xuICAgIGNvbnNvbGUubG9nKGlucHV0TmFtZSk7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogaW5wdXROYW1lLFxuICAgICAgICBhYm91dDogaW5wdXRBYm91dE1lLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxuICAgICAgfSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRMaWtlcyhjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxuICAgICAgfSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVMaWtlcyhjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxuICAgICAgfSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlQ29udGVudCA9IHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLnBvcHVwX19pbWFnZS1jb250ZW50XCJcbiAgICApO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2VIZWFkZXIgPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5wb3B1cF9faW1hZ2UtaGVhZGVyXCJcbiAgICApO1xuICB9XG5cbiAgX3JlbmRyZVBvcHVwSW1hZ2VQcmV2aWV3KCkge1xuICAgIHRoaXMuX3BvcHVwSW1hZ2VDb250ZW50LnNldEF0dHJpYnV0ZShcInNyY1wiLCBgJHt0aGlzLmxpbmt9YCk7XG4gICAgdGhpcy5fcG9wdXBJbWFnZUNvbnRlbnQuc2V0QXR0cmlidXRlKFwiYWx0XCIsIGBQaG90byBvZiAke3RoaXMubmFtZX1gKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlSGVhZGVyLnRleHRDb250ZW50ID0gdGhpcy5uYW1lO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgdGhpcy5uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMubGluayA9IGRhdGEubGluaztcbiAgICBzdXBlci5vcGVuKCk7XG4gICAgdGhpcy5fcmVuZHJlUG9wdXBJbWFnZVByZXZpZXcoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5leHBvcnQgY2xhc3MgUG9wdXBDb25maXJtRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBzZXRBY3Rpb24oYWN0aW9uKSB7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGFjdGlvbjtcbiAgfVxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XG4gICAgICBzdXBlci5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dENvbnRlbnQ7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcm9maWxlTmFtZSxcbiAgICBwcm9maWxlUHJvZmVzc2lvbixcbiAgICBwcm9maWxlSW5mb1NlbGVjdG9yLFxuICAgIHVzZXJJbWFnZVNlbGVjdG9yXG4gICkge1xuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZSk7XG4gICAgdGhpcy5fcHJvZmlsZVByb2Zlc3Npb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVQcm9mZXNzaW9uKTtcbiAgICB0aGlzLl9pZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUluZm9TZWxlY3Rvcik7XG4gICAgdGhpcy5faW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJJbWFnZVNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHVzZXJWYWx1ZXMgPSB7XG4gICAgICBwcm9maWxlTmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXG4gICAgICBwcm9maWxlUHJvZmVzc2lvbjogdGhpcy5fcHJvZmlsZVByb2Zlc3Npb24udGV4dENvbnRlbnQsXG4gICAgfTtcbiAgICByZXR1cm4gdXNlclZhbHVlcztcbiAgfVxuXG4gIHNldFVzZXJJbmZvKGlucHV0TmFtZSwgaW5wdXRBYm91dE1lLCBpZCkge1xuICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gaW5wdXROYW1lO1xuICAgIHRoaXMuX3Byb2ZpbGVQcm9mZXNzaW9uLnRleHRDb250ZW50ID0gaW5wdXRBYm91dE1lO1xuICAgIHRoaXMuX2lkLmlkID0gaWQ7XG4gIH1cblxuICBzZXRVc2VySW1hZ2UoaW1hZ2VMaW5rKSB7XG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gaW1hZ2VMaW5rO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUNhcmREZWxldGUiLCJoYW5kbGVUb2dnbGVMaWtlcyIsInVzZXJEYXRhIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9jYXJkT3duZXJJZCIsIm93bmVyIiwiX2xpa2VzIiwibGlrZXMiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUNhcmREZWxldGUiLCJfaGFuZGxlVG9nZ2xlTGlrZXMiLCJfdXNlcklkIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiaWQiLCJfdHJhc2hCdXR0b24iLCJfbGlrZUJ1dHRvbiIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VUZXh0IiwiX2xpa2VOdW1iZXIiLCJfc2hvd0xpa2VzTnVtYmVyIiwiaXNMaWtlZCIsInRvZ2dsZUxpa2VCdXR0b24iLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9zaG93VHJhc2hCdXR0b24iLCJsZW5ndGgiLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRWxlbWVudCIsInJlbW92ZSIsIm5ld0xpa2VzIiwidG9nZ2xlIiwic29tZSIsInBlcnNvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cFNlbGVjdG9yIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJGb3JtVmFsaWRhdGlvbiIsInZhbGlkYXRpb25QYXJhbXMiLCJmb3JtIiwiX2Zvcm1FbGVtZW50IiwiZm9ybVNlbGVjdG9yIiwiX2Zvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9idXR0b25FbGVtZW50IiwiX3Nob3dFcnJvciIsImlucHV0SXRlbSIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVFcnJvciIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiX2lucHV0cyIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJfc2V0RXZlbnRMaXN0ZW5lciIsInJlc2V0VmFsaWRpdHkiLCJmb3JFYWNoIiwiX3RvZ2dsZUlucHV0RXJyb3IiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYXBwZW5kSXRlbSIsImVsZW1lbnQiLCJhcHBlbmQiLCJwcmVwZW5kSXRlbSIsInByZXBlbmQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJfc3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblRleHRDb250ZW50IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsInJlc2V0IiwiaXNMb2FkaW5nIiwicHJvZmlsZUFkZEJ1dHRvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwiYXZhdGFyRWRpdEJ1dHRvbiIsInByb2ZpbGVGb3JtIiwiYWRkUGxhY2VGb3JtIiwiYXZhdGFyRm9ybSIsImNvbmZpcm1Qb3B1cCIsImlucHV0TmFtZSIsImlucHV0QWJvdXRtZSIsImltYWdlUHJldmlldyIsImFwaSIsIm9wdGlvbnMiLCJfdXJsIiwiYmFzZVVybCIsIl90b2tlbiIsInRva2VuIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckRhdGEiLCJhZGRDYXJkIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRVc2VyRGF0YSIsImlucHV0QWJvdXRNZSIsImNvbnNvbGUiLCJsb2ciLCJhYm91dCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlcyIsImRlbGV0ZUxpa2VzIiwic2V0VXNlckF2YXRhciIsImF2YXRhciIsImFkZFBsYWNlRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsInBvcHVwV2l0aEltYWdlIiwiX3BvcHVwSW1hZ2VDb250ZW50IiwiX3BvcHVwSW1hZ2VIZWFkZXIiLCJfcmVuZHJlUG9wdXBJbWFnZVByZXZpZXciLCJzZXRBdHRyaWJ1dGUiLCJjb25maXJtRGVsZXRlUG9wdXAiLCJzZXRBY3Rpb24iLCJhY3Rpb24iLCJyZW5kZXJDYXJkIiwiY2FyZCIsImltYWdlRGF0YSIsImNhdGNoIiwiZXJyIiwiZmluYWxseSIsInVzZXJJbmZvIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlUHJvZmVzc2lvbiIsInByb2ZpbGVJbmZvU2VsZWN0b3IiLCJ1c2VySW1hZ2VTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlUHJvZmVzc2lvbiIsIl9pbWFnZSIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJzZXRVc2VySW1hZ2UiLCJpbWFnZUxpbmsiLCJjYXJkU2VjdGlvbiIsImFsbCIsImNhcmRzIiwiY2FyZEVsZW1lbnQiLCJhZGRQbGFjZVBvcHVwIiwiY2FyZERhdGEiLCJwb3N0IiwicHJvZmlsZVBvcHVwIiwidXBkYXRlQXZhdGFyUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9